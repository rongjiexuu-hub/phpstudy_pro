<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ç¼˜å®¶æ•™é€š - è¿æ¥ä¼˜ç§€å®¶æ•™ä¸éœ€è¦å¸®åŠ©çš„å®¶åº­</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* å¯¼èˆªæ æ ·å¼ */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: #667eea;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #667eea;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .logout-btn:hover {
            background: #c82333;
        }

        .login-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .login-btn:hover {
            background: #218838;
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .main-content {
            margin-top: 80px;
            padding: 2rem 20px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        /* è§’è‰²åˆ‡æ¢æ ‡ç­¾ */
        .role-tabs {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .tab-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .tab-btn {
            flex: 1;
            padding: 1rem;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            background: #667eea;
            color: white;
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* åŠŸèƒ½å¡ç‰‡ */
        .action-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .action-card {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .card-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .card-description {
            color: #666;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .card-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .card-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        /* ä¿¡æ¯åˆ—è¡¨åŒºåŸŸ */
        .info-section {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
        }

        .search-bar {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .search-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-btn {
            padding: 12px 24px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s ease;
        }

        .search-btn:hover {
            background: #5a6fd8;
        }

        /* ä¿¡æ¯å¡ç‰‡ */
        .info-grid {
            display: grid;
            gap: 1.5rem;
        }

        .info-card {
            border: 1px solid #e1e5e9;
            border-radius: 10px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .info-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .info-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .info-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #333;
        }

        .info-type {
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
        }

        .info-meta {
            display: flex;
            gap: 2rem;
            margin-bottom: 1rem;
            color: #666;
            font-size: 0.9rem;
        }

        .info-description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .info-actions {
            display: flex;
            gap: 1rem;
        }

        .contact-btn {
            padding: 8px 16px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s ease;
        }

        .contact-btn:hover {
            background: #218838;
        }
        
        .secondary-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .secondary-btn:hover {
            background: #5a6268;
            transform: translateY(-1px);
        }

        .detail-btn {
            padding: 8px 16px;
            background: #17a2b8;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s ease;
        }

        .detail-btn:hover {
            background: #138496;
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        /* åˆ†é¡µæ§ä»¶æ ·å¼ */
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e1e5e9;
        }

        .pagination-info {
            color: #666;
            font-size: 0.9rem;
        }

        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .pagination-btn {
            padding: 8px 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover:not(:disabled) {
            background: #5a6fd8;
        }

        .pagination-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        #currentPageInfo {
            color: #333;
            font-weight: 500;
            min-width: 100px;
            text-align: center;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #555;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .submit-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .action-cards {
                grid-template-columns: 1fr;
            }

            .tab-buttons {
                flex-direction: column;
            }

            .search-bar {
                flex-direction: column;
            }

            .info-header {
                flex-direction: column;
                gap: 0.5rem;
            }

            .info-meta {
                flex-direction: column;
                gap: 0.5rem;
            }

            .info-actions {
                flex-direction: column;
            }
        }

        /* æ¶ˆæ¯æç¤º */
        .message {
            position: fixed;
            top: 100px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 3000;
            animation: slideIn 0.3s ease;
        }

        .message.success {
            background: #28a745;
        }

        .message.error {
            background: #dc3545;
        }

        .message.info {
            background: #17a2b8;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">å­¦ç¼˜å®¶æ•™é€š</div>
            <ul class="nav-links">
                <li><a href="#home" onclick="goToHome(event)">é¦–é¡µ</a></li>
                <li><a href="#tutors" onclick="scrollToTutorSearchWithLogin(event)">æ‰¾å®¶æ•™</a></li>
                <li><a href="#jobs" onclick="scrollToJobSearchWithLogin(event)">å®¶æ•™ä¿¡æ¯</a></li>
                <li><a href="#about">å…³äºæˆ‘ä»¬</a></li>
            </ul>
            <div class="user-menu">
                <div class="user-avatar" id="userAvatar" style="display: none;">æœª</div>
                <span id="userName" style="display: none;">æœªç™»å½•</span>
                <button class="login-btn" id="loginBtn" onclick="goToLogin()">ç™»å½•</button>
                <button class="logout-btn" id="logoutBtn" onclick="logout()" style="display: none;">é€€å‡ºç™»å½•</button>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹ -->
    <main class="main-content">
        <!-- è§’è‰²åˆ‡æ¢æ ‡ç­¾ -->
        <div class="role-tabs">
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="switchTab('parent')">
                    ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ æˆ‘æ˜¯å®¶é•¿
                </button>
                <button class="tab-btn" onclick="switchTab('tutor')">
                    ğŸ“ æˆ‘æ˜¯å®¶æ•™è€å¸ˆ
                </button>
            </div>

            <!-- å®¶é•¿åŠŸèƒ½åŒºåŸŸ -->
            <div id="parent-tab" class="tab-content active">
                <div class="action-cards">
                    <div class="action-card">
                        <div class="card-icon">ğŸ“</div>
                        <h3 class="card-title">å‘å¸ƒå®¶æ•™éœ€æ±‚</h3>
                        <p class="card-description">å‘å¸ƒæ‚¨å­©å­çš„å®¶æ•™éœ€æ±‚ï¼Œè®©ä¼˜ç§€çš„å®¶æ•™è€å¸ˆè”ç³»æ‚¨</p>
                        <button class="card-btn" onclick="openModal('parent-demand')">å‘å¸ƒéœ€æ±‚</button>
                    </div>
                    <div class="action-card">
                        <div class="card-icon">ğŸ”</div>
                        <h3 class="card-title">æœç´¢å®¶æ•™è€å¸ˆ</h3>
                        <p class="card-description">æœç´¢åˆé€‚çš„å®¶æ•™è€å¸ˆï¼ŒæŸ¥çœ‹ä»–ä»¬çš„èµ„è´¨ã€ç»éªŒå’Œè¯„ä»·</p>
                        <button class="card-btn" onclick="scrollToTutorList()">æœç´¢è€å¸ˆ</button>
                    </div>
                </div>

                <!-- å®¶æ•™è€å¸ˆåˆ—è¡¨ -->
                <div class="info-section" id="tutor-list">
                    <div class="section-header">
                        <h2 class="section-title">å®¶æ•™è€å¸ˆä¿¡æ¯</h2>
                    </div>
                    <div class="search-bar">
                        <input type="text" class="search-input" id="tutorSearch" placeholder="æœç´¢å®¶æ•™è€å¸ˆçš„ç§‘ç›®ã€åœ°åŒºã€å­¦æ ¡...">
                        <select class="search-input" id="subjectFilter" style="flex: 0 0 200px;">
                            <option value="">æ‰€æœ‰ç§‘ç›®</option>
                            <option value="æ•°å­¦">æ•°å­¦</option>
                            <option value="è¯­æ–‡">è¯­æ–‡</option>
                            <option value="è‹±è¯­">è‹±è¯­</option>
                            <option value="ç‰©ç†">ç‰©ç†</option>
                            <option value="åŒ–å­¦">åŒ–å­¦</option>
                            <option value="ç”Ÿç‰©">ç”Ÿç‰©</option>
                        </select>
                        <button class="search-btn" onclick="searchTutors()">æœç´¢è€å¸ˆ</button>
                    </div>
                    <div class="info-grid" id="tutorList">
                        <!-- åŠ¨æ€åŠ è½½å®¶æ•™è€å¸ˆåˆ—è¡¨ -->
                    </div>
                    <!-- åˆ†é¡µæ§ä»¶ -->
                    <div id="tutorPagination" class="pagination-container" style="display: none;">
                        <div class="pagination-info">
                            <span id="tutorPaginationInfo">å…± 0 æ¡è®°å½•</span>
                        </div>
                        <div class="pagination-controls">
                            <button id="prevTutorPageBtn" class="pagination-btn" onclick="changeTutorPage(-1)">ä¸Šä¸€é¡µ</button>
                            <span id="currentTutorPageInfo">ç¬¬ 1 é¡µï¼Œå…± 1 é¡µ</span>
                            <button id="nextTutorPageBtn" class="pagination-btn" onclick="changeTutorPage(1)">ä¸‹ä¸€é¡µ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å®¶æ•™è€å¸ˆåŠŸèƒ½åŒºåŸŸ -->
            <div id="tutor-tab" class="tab-content">
                <div class="action-cards">
                    <div class="action-card">
                        <div class="card-icon">ğŸ“</div>
                        <h3 class="card-title">æˆä¸ºå®¶æ•™è€å¸ˆ</h3>
                        <p class="card-description">å‘å¸ƒæ‚¨çš„å®¶æ•™ä¿¡æ¯ï¼Œå±•ç¤ºæ•™å­¦èƒ½åŠ›ï¼Œå¯»æ‰¾åˆé€‚çš„å­¦ç”Ÿ</p>
                        <button class="card-btn" onclick="openModal('tutor-profile')">æˆä¸ºå®¶æ•™è€å¸ˆ</button>
                    </div>
                    <div class="action-card">
                        <div class="card-icon">ğŸ”</div>
                        <h3 class="card-title">æœç´¢å®¶æ•™ä¿¡æ¯</h3>
                        <p class="card-description">æœç´¢å®¶é•¿å‘å¸ƒçš„å®¶æ•™éœ€æ±‚ï¼Œæ‰¾åˆ°åˆé€‚çš„æ•™å­¦æœºä¼š</p>
                        <button class="card-btn" onclick="scrollToJobList()">æœç´¢éœ€æ±‚</button>
                    </div>
                </div>

                <!-- å®¶æ•™éœ€æ±‚åˆ—è¡¨ -->
                <div class="info-section" id="job-list">
                    <div class="section-header">
                        <h2 class="section-title">å®¶æ•™ä¿¡æ¯</h2>
                    </div>
                    <div class="search-bar">
                        <input type="text" class="search-input" id="jobSearch" placeholder="æœç´¢å®¶æ•™ä¿¡æ¯çš„ç§‘ç›®ã€åœ°åŒºã€è–ªèµ„...">
                        <select class="search-input" id="jobSubjectFilter" style="flex: 0 0 200px;">
                            <option value="">æ‰€æœ‰ç§‘ç›®</option>
                            <option value="æ•°å­¦">æ•°å­¦</option>
                            <option value="è¯­æ–‡">è¯­æ–‡</option>
                            <option value="è‹±è¯­">è‹±è¯­</option>
                            <option value="ç‰©ç†">ç‰©ç†</option>
                            <option value="åŒ–å­¦">åŒ–å­¦</option>
                            <option value="ç”Ÿç‰©">ç”Ÿç‰©</option>
                        </select>
                        <button class="search-btn" onclick="searchJobs()">æœç´¢å®¶æ•™ä¿¡æ¯</button>
                    </div>
                    <div class="info-grid" id="jobList">
                        <!-- åŠ¨æ€åŠ è½½å®¶æ•™éœ€æ±‚åˆ—è¡¨ -->
                    </div>
                    <!-- åˆ†é¡µæ§ä»¶ -->
                    <div id="jobPagination" class="pagination-container" style="display: none;">
                        <div class="pagination-info">
                            <span id="paginationInfo">å…± 0 æ¡è®°å½•</span>
                        </div>
                        <div class="pagination-controls">
                            <button id="prevPageBtn" class="pagination-btn" onclick="changeJobPage(-1)">ä¸Šä¸€é¡µ</button>
                            <span id="currentPageInfo">ç¬¬ 1 é¡µï¼Œå…± 1 é¡µ</span>
                            <button id="nextPageBtn" class="pagination-btn" onclick="changeJobPage(1)">ä¸‹ä¸€é¡µ</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- å‘å¸ƒå®¶é•¿éœ€æ±‚æ¨¡æ€æ¡† -->
    <div id="parent-demand" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">å‘å¸ƒå®¶æ•™éœ€æ±‚</h2>
                <button class="close-btn" onclick="closeModal('parent-demand')">Ã—</button>
            </div>
            <form id="parentDemandForm">
                <div class="form-group">
                    <label for="studentName">å­¦ç”Ÿå§“å</label>
                    <input type="text" id="studentName" required>
                </div>
                <div class="form-group">
                    <label for="grade">å¹´çº§</label>
                    <select id="grade" required>
                        <option value="">è¯·é€‰æ‹©å¹´çº§</option>
                        <option value="å°å­¦ä¸€å¹´çº§">å°å­¦ä¸€å¹´çº§</option>
                        <option value="å°å­¦äºŒå¹´çº§">å°å­¦äºŒå¹´çº§</option>
                        <option value="å°å­¦ä¸‰å¹´çº§">å°å­¦ä¸‰å¹´çº§</option>
                        <option value="å°å­¦å››å¹´çº§">å°å­¦å››å¹´çº§</option>
                        <option value="å°å­¦äº”å¹´çº§">å°å­¦äº”å¹´çº§</option>
                        <option value="å°å­¦å…­å¹´çº§">å°å­¦å…­å¹´çº§</option>
                        <option value="åˆä¸­ä¸€å¹´çº§">åˆä¸­ä¸€å¹´çº§</option>
                        <option value="åˆä¸­äºŒå¹´çº§">åˆä¸­äºŒå¹´çº§</option>
                        <option value="åˆä¸­ä¸‰å¹´çº§">åˆä¸­ä¸‰å¹´çº§</option>
                        <option value="é«˜ä¸­ä¸€å¹´çº§">é«˜ä¸­ä¸€å¹´çº§</option>
                        <option value="é«˜ä¸­äºŒå¹´çº§">é«˜ä¸­äºŒå¹´çº§</option>
                        <option value="é«˜ä¸­ä¸‰å¹´çº§">é«˜ä¸­ä¸‰å¹´çº§</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="subjects">éœ€è¦è¾…å¯¼çš„ç§‘ç›®</label>
                    <input type="text" id="subjects" placeholder="å¦‚ï¼šæ•°å­¦ã€è‹±è¯­" required>
                </div>
                <div class="form-group">
                    <label for="location">ä¸Šè¯¾åœ°ç‚¹</label>
                    <input type="text" id="location" placeholder="å¦‚ï¼šæµ·æ·€åŒºä¸­å…³æ‘" required>
                </div>
                <div class="form-group">
                    <label for="schedule">ä¸Šè¯¾æ—¶é—´</label>
                    <input type="text" id="schedule" placeholder="å¦‚ï¼šå‘¨æœ«ä¸Šåˆ" required>
                </div>
                <div class="form-group">
                    <label for="salary">è–ªèµ„å¾…é‡</label>
                    <input type="text" id="salary" placeholder="å¦‚ï¼š100-150å…ƒ/å°æ—¶" required>
                </div>
                <div class="form-group">
                    <label for="requirements">å…·ä½“è¦æ±‚</label>
                    <textarea id="requirements" placeholder="è¯·æè¿°æ‚¨çš„å…·ä½“è¦æ±‚ï¼Œå¦‚å­©å­å­¦ä¹ æƒ…å†µã€æœŸæœ›çš„æ•™å­¦æ–¹å¼ç­‰"></textarea>
                </div>
                <div class="form-group">
                    <label for="contactPhone">è”ç³»ç”µè¯</label>
                    <input type="tel" id="contactPhone" required>
                </div>
                <button type="submit" class="submit-btn">å‘å¸ƒéœ€æ±‚</button>
            </form>
        </div>
    </div>

    <!-- å‘å¸ƒå®¶æ•™è€å¸ˆä¿¡æ¯æ¨¡æ€æ¡† -->
    <div id="tutor-profile" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">æˆä¸ºå®¶æ•™è€å¸ˆ</h2>
                <button class="close-btn" onclick="closeModal('tutor-profile')">Ã—</button>
            </div>
            <form id="tutorProfileForm">
                <div class="form-group">
                    <label for="tutorName">å§“å</label>
                    <input type="text" id="tutorName" required>
                </div>
                <div class="form-group">
                    <label for="education">æ•™è‚²èƒŒæ™¯</label>
                    <input type="text" id="education" placeholder="å¦‚ï¼šæ¸…åå¤§å­¦è®¡ç®—æœºç³»å¤§ä¸‰" required>
                </div>
                <div class="form-group">
                    <label for="subjects">æ“…é•¿ç§‘ç›®</label>
                    <input type="text" id="tutorSubjects" placeholder="å¦‚ï¼šæ•°å­¦ã€ç‰©ç†ã€ç¼–ç¨‹" required>
                </div>
                <div class="form-group">
                    <label for="experience">æ•™å­¦ç»éªŒ</label>
                    <input type="text" id="experience" placeholder="å¦‚ï¼š3å¹´æ•™å­¦ç»éªŒ" required>
                </div>
                <div class="form-group">
                    <label for="teachingAreas">å¯æˆè¯¾åœ°åŒº</label>
                    <input type="text" id="teachingAreas" placeholder="å¦‚ï¼šæµ·æ·€åŒºã€æœé˜³åŒº" required>
                </div>
                <div class="form-group">
                    <label for="tutorSchedule">å¯æˆè¯¾æ—¶é—´</label>
                    <input type="text" id="tutorSchedule" placeholder="å¦‚ï¼šå‘¨æœ«å…¨å¤©ã€å·¥ä½œæ—¥æ™šä¸Š" required>
                </div>
                <div class="form-group">
                    <label for="tutorSalary">æœŸæœ›è–ªèµ„</label>
                    <input type="text" id="tutorSalary" placeholder="å¦‚ï¼š120-200å…ƒ/å°æ—¶" required>
                </div>
                <div class="form-group">
                    <label for="teachingStyle">æ•™å­¦ç‰¹è‰²</label>
                    <textarea id="teachingStyle" placeholder="è¯·æè¿°æ‚¨çš„æ•™å­¦ç‰¹è‰²å’Œæ–¹æ³•"></textarea>
                </div>
                <div class="form-group">
                    <label for="tutorPhone">è”ç³»ç”µè¯</label>
                    <input type="tel" id="tutorPhone" required>
                </div>
                <button type="submit" class="submit-btn">å‘å¸ƒä¿¡æ¯</button>
            </form>
        </div>
    </div>

    <!-- è”ç³»æ¨¡æ€æ¡† -->
    <div id="contact" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">è”ç³»ä¿¡æ¯</h2>
                <button class="close-btn" onclick="closeModal('contact')">Ã—</button>
            </div>
            <div id="contactInfo">
                <!-- åŠ¨æ€æ˜¾ç¤ºè”ç³»ä¿¡æ¯ -->
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentUser = null;
        let currentRole = 'parent';
        
        // åˆ†é¡µç›¸å…³å…¨å±€å˜é‡
        let currentPage = 1;
        let totalPages = 1;
        let totalRecords = 0;
        const recordsPerPage = 5;
        let allJobs = []; // å­˜å‚¨æ‰€æœ‰å®¶æ•™ä¿¡æ¯
        let allTutors = []; // å­˜å‚¨æ‰€æœ‰å®¶æ•™è€å¸ˆ
        let currentTutorPage = 1;
        let totalTutorPages = 0;
        let totalTutorRecords = 0;

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateUserDisplay();
            loadTutorList();
            loadJobList();
        });

        // æ›´æ–°ç”¨æˆ·æ˜¾ç¤ºçŠ¶æ€
        function updateUserDisplay() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            const loginBtn = document.getElementById('loginBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            const userAvatar = document.getElementById('userAvatar');
            const userName = document.getElementById('userName');

            if (currentUser && currentUser.id) {
                // ç”¨æˆ·å·²ç™»å½•
                loginBtn.style.display = 'none';
                logoutBtn.style.display = 'block';
                userAvatar.style.display = 'block';
                userName.style.display = 'block';
                userName.textContent = currentUser.fullName || currentUser.username;
                userAvatar.textContent = (currentUser.fullName || currentUser.username).charAt(0);
            } else {
                // ç”¨æˆ·æœªç™»å½•
                loginBtn.style.display = 'block';
                logoutBtn.style.display = 'none';
                userAvatar.style.display = 'none';
                userName.style.display = 'none';
            }
        }

        // æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€
        function checkAuthStatus() {
            fetch('check_auth.php')
                .then(response => response.json())
                .then(data => {
                    if (data.logged_in) {
                        currentUser = data.user;
                        updateUserDisplay();
                    } else {
                        // ä¸è‡ªåŠ¨è·³è½¬ï¼Œåªæ˜¾ç¤ºæç¤ºä¿¡æ¯
                        showMessage('æ‚¨å°šæœªç™»å½•ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½æ— æ³•ä½¿ç”¨', 'info');
                    }
                })
                .catch(error => {
                    console.error('æ£€æŸ¥ç™»å½•çŠ¶æ€å¤±è´¥:', error);
                    showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥', 'error');
                });
        }

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(role) {
            currentRole = role;
            
            // æ›´æ–°æ ‡ç­¾æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // æ›´æ–°æ ‡ç­¾å†…å®¹æ˜¾ç¤º
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            if (role === 'parent') {
                document.getElementById('parent-tab').classList.add('active');
            } else {
                document.getElementById('tutor-tab').classList.add('active');
            }
        }

        // æ‰“å¼€æ¨¡æ€æ¡†
        function openModal(modalId) {
            // æ£€æŸ¥æ˜¯å¦éœ€è¦ç™»å½•çš„åŠŸèƒ½
            if (modalId === 'parent-demand' || modalId === 'tutor-profile') {
                if (!checkLoginStatus()) {
                    showLoginRequired();
                    return;
                }
            }
            
            document.getElementById(modalId).style.display = 'block';
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // æ»šåŠ¨åˆ°æŒ‡å®šåŒºåŸŸ
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(text, type = 'info') {
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.remove();
            }, 3000);
        }

        // å‘å¸ƒå®¶é•¿éœ€æ±‚è¡¨å•æäº¤
        document.getElementById('parentDemandForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
            if (!checkLoginStatus()) {
                showMessage('è¯·å…ˆç™»å½•åå†å‘å¸ƒéœ€æ±‚', 'warning');
                return;
            }
            
            const formData = {
                student_name: document.getElementById('studentName').value,
                grade: document.getElementById('grade').value,
                subjects: document.getElementById('subjects').value,
                location: document.getElementById('location').value,
                schedule: document.getElementById('schedule').value,
                salary: document.getElementById('salary').value,
                requirements: document.getElementById('requirements').value,
                contact_phone: document.getElementById('contactPhone').value,
                user_id: JSON.parse(localStorage.getItem('currentUser')).id
            };
            
            // å‘é€APIè¯·æ±‚
            fetch('api_add_tutoring_request.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showMessage('å®¶æ•™éœ€æ±‚å‘å¸ƒæˆåŠŸï¼', 'success');
                    closeModal('parent-demand');
                    this.reset();
                    // é‡æ–°åŠ è½½åˆ—è¡¨å¹¶é‡ç½®åˆ°ç¬¬ä¸€é¡µ
                    loadJobListFromAPI();
                } else {
                    showMessage('å‘å¸ƒå¤±è´¥ï¼š' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
            });
        });

        // å‘å¸ƒå®¶æ•™è€å¸ˆä¿¡æ¯è¡¨å•æäº¤
        document.getElementById('tutorProfileForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
            if (!checkLoginStatus()) {
                showMessage('è¯·å…ˆç™»å½•åå†å‘å¸ƒå®¶æ•™å…¼èŒä¿¡æ¯', 'warning');
                return;
            }
            
            const formData = {
                name: document.getElementById('tutorName').value,
                education: document.getElementById('education').value,
                subjects: document.getElementById('tutorSubjects').value,
                experience: document.getElementById('experience').value,
                teaching_areas: document.getElementById('teachingAreas').value,
                schedule: document.getElementById('tutorSchedule').value,
                salary: document.getElementById('tutorSalary').value,
                teaching_style: document.getElementById('teachingStyle').value,
                contact_phone: document.getElementById('tutorPhone').value,
                user_id: JSON.parse(localStorage.getItem('currentUser')).id
            };
            
            // å‘é€APIè¯·æ±‚
            fetch('api_add_tutor_profile.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showMessage('å®¶æ•™å…¼èŒä¿¡æ¯å‘å¸ƒæˆåŠŸï¼', 'success');
                    closeModal('tutor-profile');
                    this.reset();
                    // é‡æ–°åŠ è½½è€å¸ˆåˆ—è¡¨
                    loadTutorListFromAPI();
                } else {
                    showMessage('å‘å¸ƒå¤±è´¥ï¼š' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
            });
        });

        // ä»APIåŠ è½½å®¶æ•™è€å¸ˆåˆ—è¡¨
        function loadTutorListFromAPI() {
            const tutorList = document.getElementById('tutorList');
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            tutorList.innerHTML = '<div style="text-align: center; padding: 2rem;">æ­£åœ¨åŠ è½½å®¶æ•™è€å¸ˆä¿¡æ¯...</div>';
            
            // ä»APIè·å–æ•°æ®
            fetch('api_get_tutor_profiles.php?limit=100') // è·å–æ›´å¤šæ•°æ®ç”¨äºåˆ†é¡µ
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data.profiles.length > 0) {
                        allTutors = data.data.profiles;
                        totalTutorRecords = allTutors.length;
                        totalTutorPages = Math.ceil(totalTutorRecords / recordsPerPage);
                        currentTutorPage = 1; // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
                        
                        displayTutorsPage();
                        updateTutorPaginationInfo();
                    } else {
                        allTutors = [];
                        totalTutorRecords = 0;
                        totalTutorPages = 0;
                        tutorList.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">æš‚æ— å®¶æ•™è€å¸ˆä¿¡æ¯</div>';
                        document.getElementById('tutorPagination').style.display = 'none';
                    }
                })
                .catch(error => {
                    console.error('Error loading tutors:', error);
                    tutorList.innerHTML = '<div style="text-align: center; padding: 2rem; color: red;">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</div>';
                    document.getElementById('tutorPagination').style.display = 'none';
                });
        }

        // æ˜¾ç¤ºå½“å‰é¡µçš„å®¶æ•™è€å¸ˆ
        function displayTutorsPage() {
            const tutorList = document.getElementById('tutorList');
            const startIndex = (currentTutorPage - 1) * recordsPerPage;
            const endIndex = startIndex + recordsPerPage;
            const currentTutors = allTutors.slice(startIndex, endIndex);
            
            if (currentTutors.length > 0) {
                tutorList.innerHTML = currentTutors.map(tutor => `
                    <div class="info-card">
                        <div class="info-header">
                            <h3 class="info-title">${tutor.name}</h3>
                            <span class="info-type">${tutor.subjects}</span>
                        </div>
                        <div class="info-meta">
                            <span>ğŸ“ ${tutor.education}</span>
                            <span>ğŸ’¼ ${tutor.experience}</span>
                            <span>ğŸ’° ${tutor.salary}</span>
                        </div>
                        <div class="info-description">
                            å¯æˆè¯¾åœ°åŒºï¼š${tutor.teaching_areas}
                        </div>
                        <div class="info-actions">
                            <button class="contact-btn" onclick="showContactInfo('${tutor.name}', '${tutor.contact_phone}')">è”ç³»è€å¸ˆ</button>
                            <button class="detail-btn" onclick="showTutorDetail(${tutor.id})">æŸ¥çœ‹è¯¦æƒ…</button>
                        </div>
                    </div>
                `).join('');
            } else {
                tutorList.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">å½“å‰é¡µé¢æ²¡æœ‰å®¶æ•™è€å¸ˆä¿¡æ¯</div>';
            }
        }

        // æ›´æ–°å®¶æ•™è€å¸ˆåˆ†é¡µä¿¡æ¯
        function updateTutorPaginationInfo() {
            const paginationContainer = document.getElementById('tutorPagination');
            
            if (totalTutorRecords > recordsPerPage) {
                paginationContainer.style.display = 'flex';
                
                // æ›´æ–°è®°å½•ä¿¡æ¯
                document.getElementById('tutorPaginationInfo').textContent = `å…± ${totalTutorRecords} æ¡è®°å½•`;
                
                // æ›´æ–°é¡µé¢ä¿¡æ¯
                document.getElementById('currentTutorPageInfo').textContent = `ç¬¬ ${currentTutorPage} é¡µï¼Œå…± ${totalTutorPages} é¡µ`;
                
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.getElementById('prevTutorPageBtn').disabled = currentTutorPage <= 1;
                document.getElementById('nextTutorPageBtn').disabled = currentTutorPage >= totalTutorPages;
            } else {
                paginationContainer.style.display = 'none';
            }
        }

        // åˆ‡æ¢å®¶æ•™è€å¸ˆé¡µé¢
        function changeTutorPage(direction) {
            const newPage = currentTutorPage + direction;
            
            if (newPage >= 1 && newPage <= totalTutorPages) {
                currentTutorPage = newPage;
                displayTutorsPage();
                updateTutorPaginationInfo();
                
                // æ»šåŠ¨åˆ°å®¶æ•™è€å¸ˆåˆ—è¡¨é¡¶éƒ¨
                document.getElementById('tutorList').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // ä¿ç•™åŸæœ‰å‡½æ•°ä½œä¸ºå¤‡ç”¨
        function loadTutorList() {
            loadTutorListFromAPI();
        }

        // ä»APIåŠ è½½å®¶æ•™éœ€æ±‚åˆ—è¡¨
        function loadJobListFromAPI() {
            const jobList = document.getElementById('jobList');
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            jobList.innerHTML = '<div style="text-align: center; padding: 2rem;">æ­£åœ¨åŠ è½½å®¶æ•™ä¿¡æ¯...</div>';
            
            // ä»APIè·å–æ•°æ®
            fetch('api_get_tutoring_requests.php?limit=100') // è·å–æ›´å¤šæ•°æ®ç”¨äºåˆ†é¡µ
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data.requests.length > 0) {
                        allJobs = data.data.requests;
                        totalRecords = allJobs.length;
                        totalPages = Math.ceil(totalRecords / recordsPerPage);
                        currentPage = 1; // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
                        
                        displayJobsPage();
                        updatePaginationInfo();
                    } else {
                        allJobs = [];
                        totalRecords = 0;
                        totalPages = 0;
                        jobList.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">æš‚æ— å®¶æ•™ä¿¡æ¯</div>';
                        document.getElementById('jobPagination').style.display = 'none';
                    }
                })
                .catch(error => {
                    console.error('Error loading jobs:', error);
                    jobList.innerHTML = '<div style="text-align: center; padding: 2rem; color: red;">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</div>';
                    document.getElementById('jobPagination').style.display = 'none';
                });
        }

        // æ˜¾ç¤ºå½“å‰é¡µçš„å®¶æ•™ä¿¡æ¯
        function displayJobsPage() {
            const jobList = document.getElementById('jobList');
            const startIndex = (currentPage - 1) * recordsPerPage;
            const endIndex = startIndex + recordsPerPage;
            const currentJobs = allJobs.slice(startIndex, endIndex);
            
            if (currentJobs.length > 0) {
                jobList.innerHTML = currentJobs.map(job => `
                    <div class="info-card">
                        <div class="info-header">
                            <h3 class="info-title">${job.student_name} (${job.grade})</h3>
                            <span class="info-type">${job.subjects}</span>
                        </div>
                        <div class="info-meta">
                            <span>ğŸ“ ${job.location}</span>
                            <span>â° ${job.schedule}</span>
                            <span>ğŸ’° ${job.salary}</span>
                        </div>
                        ${job.requirements ? `<div class="info-description">${job.requirements}</div>` : ''}
                        <div class="info-actions">
                            <button class="contact-btn" onclick="showContactInfo('${job.parent_name}', '${job.contact_phone}')">è”ç³»å®¶é•¿</button>
                            <button class="detail-btn" onclick="showJobDetail(${job.id})">æŸ¥çœ‹è¯¦æƒ…</button>
                        </div>
                    </div>
                `).join('');
            } else {
                jobList.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">å½“å‰é¡µé¢æ²¡æœ‰å®¶æ•™ä¿¡æ¯</div>';
            }
        }

        // æ›´æ–°åˆ†é¡µä¿¡æ¯
        function updatePaginationInfo() {
            const paginationContainer = document.getElementById('jobPagination');
            
            if (totalRecords > recordsPerPage) {
                paginationContainer.style.display = 'flex';
                
                // æ›´æ–°è®°å½•ä¿¡æ¯
                document.getElementById('paginationInfo').textContent = `å…± ${totalRecords} æ¡è®°å½•`;
                
                // æ›´æ–°é¡µé¢ä¿¡æ¯
                document.getElementById('currentPageInfo').textContent = `ç¬¬ ${currentPage} é¡µï¼Œå…± ${totalPages} é¡µ`;
                
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.getElementById('prevPageBtn').disabled = currentPage <= 1;
                document.getElementById('nextPageBtn').disabled = currentPage >= totalPages;
            } else {
                paginationContainer.style.display = 'none';
            }
        }

        // åˆ‡æ¢é¡µé¢
        function changeJobPage(direction) {
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                displayJobsPage();
                updatePaginationInfo();
                
                // æ»šåŠ¨åˆ°å®¶æ•™ä¿¡æ¯åˆ—è¡¨é¡¶éƒ¨
                document.getElementById('jobList').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // ä¿ç•™åŸæœ‰å‡½æ•°ä½œä¸ºå¤‡ç”¨
        function loadJobList() {
            loadJobListFromAPI();
        }

        // æœç´¢å®¶æ•™è€å¸ˆ
        function searchTutors() {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkLoginStatus()) {
                showLoginRequired();
                return;
            }
            
            const searchTerm = document.getElementById('tutorSearch').value;
            const subjectFilter = document.getElementById('subjectFilter').value;
            
            showMessage(`æ­£åœ¨æœç´¢å®¶æ•™è€å¸ˆ: ${searchTerm || 'å…¨éƒ¨'} ${subjectFilter ? '(' + subjectFilter + ')' : ''}`, 'info');
            
            // æ„å»ºæœç´¢URL
            let searchUrl = 'api_get_tutor_profiles.php?limit=100';
            if (searchTerm) {
                searchUrl += `&search=${encodeURIComponent(searchTerm)}`;
            }
            if (subjectFilter) {
                searchUrl += `&subject=${encodeURIComponent(subjectFilter)}`;
            }
            
            const tutorList = document.getElementById('tutorList');
            tutorList.innerHTML = '<div style="text-align: center; padding: 2rem;">æ­£åœ¨æœç´¢å®¶æ•™è€å¸ˆ...</div>';
            
            // ä»APIè·å–æœç´¢ç»“æœ
            fetch(searchUrl)
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data.profiles.length > 0) {
                        allTutors = data.data.profiles;
                        totalTutorRecords = allTutors.length;
                        totalTutorPages = Math.ceil(totalTutorRecords / recordsPerPage);
                        currentTutorPage = 1; // æœç´¢ç»“æœé‡ç½®åˆ°ç¬¬ä¸€é¡µ
                        
                        displayTutorsPage();
                        updateTutorPaginationInfo();
                    } else {
                        allTutors = [];
                        totalTutorRecords = 0;
                        totalTutorPages = 0;
                        tutorList.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">æœªæ‰¾åˆ°åŒ¹é…çš„å®¶æ•™è€å¸ˆ</div>';
                        document.getElementById('tutorPagination').style.display = 'none';
                    }
                })
                .catch(error => {
                    console.error('Error searching tutors:', error);
                    tutorList.innerHTML = '<div style="text-align: center; padding: 2rem; color: red;">æœç´¢å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</div>';
                    document.getElementById('tutorPagination').style.display = 'none';
                });
        }

        // æœç´¢å®¶æ•™éœ€æ±‚
        function searchJobs() {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkLoginStatus()) {
                showLoginRequired();
                return;
            }
            
            const searchTerm = document.getElementById('jobSearch').value;
            const subjectFilter = document.getElementById('jobSubjectFilter').value;
            
            showMessage(`æ­£åœ¨æœç´¢å®¶æ•™ä¿¡æ¯: ${searchTerm || 'å…¨éƒ¨'} ${subjectFilter ? '(' + subjectFilter + ')' : ''}`, 'info');
            
            // æ„å»ºæœç´¢URL
            let searchUrl = 'api_get_tutoring_requests.php?limit=100';
            if (searchTerm) {
                searchUrl += `&search=${encodeURIComponent(searchTerm)}`;
            }
            if (subjectFilter) {
                searchUrl += `&subject=${encodeURIComponent(subjectFilter)}`;
            }
            
            const jobList = document.getElementById('jobList');
            jobList.innerHTML = '<div style="text-align: center; padding: 2rem;">æ­£åœ¨æœç´¢å®¶æ•™ä¿¡æ¯...</div>';
            
            // ä»APIè·å–æœç´¢ç»“æœ
            fetch(searchUrl)
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data.requests.length > 0) {
                        allJobs = data.data.requests;
                        totalRecords = allJobs.length;
                        totalPages = Math.ceil(totalRecords / recordsPerPage);
                        currentPage = 1; // æœç´¢ç»“æœé‡ç½®åˆ°ç¬¬ä¸€é¡µ
                        
                        displayJobsPage();
                        updatePaginationInfo();
                    } else {
                        allJobs = [];
                        totalRecords = 0;
                        totalPages = 0;
                        jobList.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">æœªæ‰¾åˆ°åŒ¹é…çš„å®¶æ•™ä¿¡æ¯</div>';
                        document.getElementById('jobPagination').style.display = 'none';
                    }
                })
                .catch(error => {
                    console.error('Error searching jobs:', error);
                    jobList.innerHTML = '<div style="text-align: center; padding: 2rem; color: red;">æœç´¢å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</div>';
                    document.getElementById('jobPagination').style.display = 'none';
                });
        }

        // æ»šåŠ¨åˆ°å®¶æ•™è€å¸ˆåˆ—è¡¨ï¼ˆéœ€è¦ç™»å½•ï¼‰
        function scrollToTutorList() {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkLoginStatus()) {
                showLoginRequired();
                return;
            }
            
            // åˆ‡æ¢åˆ°å®¶é•¿æ ‡ç­¾é¡µ
            switchTab('parent');
            
            // å»¶è¿Ÿæ»šåŠ¨ï¼Œç¡®ä¿æ ‡ç­¾åˆ‡æ¢å®Œæˆ
            setTimeout(() => {
                const tutorList = document.getElementById('tutor-list');
                if (tutorList) {
                    tutorList.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                }
            }, 100);
        }

        // æ»šåŠ¨åˆ°å®¶æ•™éœ€æ±‚åˆ—è¡¨ï¼ˆéœ€è¦ç™»å½•ï¼‰
        function scrollToJobList() {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkLoginStatus()) {
                showLoginRequired();
                return;
            }
            
            // åˆ‡æ¢åˆ°å®¶æ•™è€å¸ˆæ ‡ç­¾é¡µ
            switchTab('tutor');
            
            // å»¶è¿Ÿæ»šåŠ¨ï¼Œç¡®ä¿æ ‡ç­¾åˆ‡æ¢å®Œæˆ
            setTimeout(() => {
                const jobList = document.getElementById('job-list');
                if (jobList) {
                    jobList.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                }
            }, 100);
        }

        // å¤åˆ¶ç”µè¯å·ç åˆ°å‰ªè´´æ¿
        function copyPhoneNumber(phone) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(phone).then(function() {
                    showMessage('ç”µè¯å·ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
                }).catch(function(err) {
                    // å¤‡ç”¨æ–¹æ³•
                    fallbackCopyTextToClipboard(phone);
                });
            } else {
                // å¤‡ç”¨æ–¹æ³•
                fallbackCopyTextToClipboard(phone);
            }
        }

        // å¤‡ç”¨å¤åˆ¶æ–¹æ³•
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showMessage('ç”µè¯å·ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
                } else {
                    showMessage('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
                }
            } catch (err) {
                showMessage('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
            }
            
            document.body.removeChild(textArea);
        }

        // æ˜¾ç¤ºè”ç³»ä¿¡æ¯
        function showContactInfo(name, phone) {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkLoginStatus()) {
                showLoginRequired();
                return;
            }
            
            // åˆ¤æ–­å½“å‰ç”¨æˆ·è§’è‰²æ¥æ˜¾ç¤ºä¸åŒçš„è”ç³»ä¿¡æ¯
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            const isTutor = currentUser.user_type === 'tutor';
            
            let contactTitle = 'è”ç³»ä¿¡æ¯';
            let contactMessage = 'è¯·åœ¨åˆé€‚çš„æ—¶é—´è”ç³»å¯¹æ–¹ï¼Œè¯´æ˜æ‚¨æ˜¯é€šè¿‡å­¦ç¼˜å®¶æ•™é€šå¹³å°çœ‹åˆ°çš„è”ç³»ä¿¡æ¯ã€‚';
            
            if (isTutor) {
                contactTitle = 'å®¶é•¿è”ç³»ä¿¡æ¯';
                contactMessage = 'æ‚¨å¥½ï¼æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹è”ç³»æ–¹å¼ç›´æ¥ä¸å®¶é•¿æ²Ÿé€šï¼Œè¯·è¯´æ˜æ‚¨æ˜¯é€šè¿‡å­¦ç¼˜å®¶æ•™é€šå¹³å°äº†è§£åˆ°æ­¤ä¿¡æ¯çš„ã€‚å»ºè®®åœ¨å·¥ä½œæ—¶é—´ï¼ˆä¸Šåˆ9:00-æ™šä¸Š9:00ï¼‰è”ç³»ã€‚';
            } else {
                contactTitle = 'è€å¸ˆè”ç³»ä¿¡æ¯';
                contactMessage = 'æ‚¨å¥½ï¼æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹è”ç³»æ–¹å¼ä¸å®¶æ•™è€å¸ˆæ²Ÿé€šï¼Œè¯·è¯´æ˜æ‚¨æ˜¯é€šè¿‡å­¦ç¼˜å®¶æ•™é€šå¹³å°äº†è§£åˆ°æ­¤ä¿¡æ¯çš„ã€‚';
            }
            
            const contactInfo = document.getElementById('contactInfo');
            contactInfo.innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <h3 style="color: #333; margin-bottom: 1rem;">${contactTitle}</h3>
                    <p style="font-size: 1.1rem; color: #555; margin-bottom: 1rem;">
                        <strong>${name}</strong>
                    </p>
                    <p style="font-size: 1.3rem; color: #667eea; margin-bottom: 1rem; font-weight: bold;">
                        ğŸ“ ${phone}
                    </p>
                    <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                        <p style="color: #666; line-height: 1.6; margin: 0;">
                            ${contactMessage}
                        </p>
                    </div>
                    <div style="margin-top: 1.5rem;">
                        <button class="contact-btn" onclick="copyPhoneNumber('${phone}')" style="margin-right: 0.5rem;">
                            ğŸ“‹ å¤åˆ¶ç”µè¯å·ç 
                        </button>
                        <button class="secondary-btn" onclick="closeModal('contact')" style="margin-left: 0.5rem;">
                            å…³é—­
                        </button>
                    </div>
                </div>
            `;
            openModal('contact');
        }

        // æ˜¾ç¤ºå®¶æ•™è€å¸ˆè¯¦æƒ…
        function showTutorDetail(tutorId) {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkLoginStatus()) {
                showLoginRequired();
                return;
            }
            
            showMessage(`æŸ¥çœ‹å®¶æ•™è€å¸ˆè¯¦æƒ… (ID: ${tutorId})`, 'info');
            // è¿™é‡Œå¯ä»¥æ‰“å¼€è¯¦æƒ…é¡µé¢æˆ–æ¨¡æ€æ¡†
        }

        // æ˜¾ç¤ºå®¶æ•™éœ€æ±‚è¯¦æƒ…
        function showJobDetail(jobId) {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkLoginStatus()) {
                showLoginRequired();
                return;
            }
            
            showMessage(`æŸ¥çœ‹å®¶æ•™éœ€æ±‚è¯¦æƒ… (ID: ${jobId})`, 'info');
            // è¿™é‡Œå¯ä»¥æ‰“å¼€è¯¦æƒ…é¡µé¢æˆ–æ¨¡æ€æ¡†
        }

        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
        function checkLoginStatus() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            return currentUser && currentUser.id;
        }

        // è·³è½¬åˆ°ç™»å½•é¡µé¢
        function goToLogin() {
            window.location.href = 'login.html';
        }

        // æ˜¾ç¤ºéœ€è¦ç™»å½•çš„æç¤º
        function showLoginRequired() {
            showMessage('è¯·å…ˆç™»å½•åå†ä½¿ç”¨æ­¤åŠŸèƒ½', 'info');
            setTimeout(() => {
                goToLogin();
            }, 1500);
        }

        // æ»šåŠ¨åˆ°å®¶æ•™è€å¸ˆæœç´¢åŠŸèƒ½ï¼ˆå¸¦ç™»å½•æ£€æŸ¥ï¼‰
        function scrollToTutorSearchWithLogin(event) {
            event.preventDefault();
            
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkLoginStatus()) {
                showLoginRequired();
                return;
            }
            
            // åˆ‡æ¢åˆ°å®¶é•¿æ ‡ç­¾é¡µ
            switchTab('parent');
            
            // å»¶è¿Ÿæ»šåŠ¨ï¼Œç¡®ä¿æ ‡ç­¾åˆ‡æ¢å®Œæˆ
            setTimeout(() => {
                const tutorList = document.getElementById('tutor-list');
                if (tutorList) {
                    tutorList.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                    
                    // èšç„¦åˆ°æœç´¢æ¡†
                    const searchInput = document.getElementById('tutorSearch');
                    if (searchInput) {
                        searchInput.focus();
                    }
                }
            }, 100);
        }

        // æ»šåŠ¨åˆ°å®¶æ•™ä¿¡æ¯æœç´¢åŠŸèƒ½ï¼ˆå¸¦ç™»å½•æ£€æŸ¥ï¼‰
        function scrollToJobSearchWithLogin(event) {
            event.preventDefault();
            
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkLoginStatus()) {
                showLoginRequired();
                return;
            }
            
            // åˆ‡æ¢åˆ°å®¶æ•™è€å¸ˆæ ‡ç­¾é¡µ
            switchTab('tutor');
            
            // å»¶è¿Ÿæ»šåŠ¨ï¼Œç¡®ä¿æ ‡ç­¾åˆ‡æ¢å®Œæˆ
            setTimeout(() => {
                const jobList = document.getElementById('job-list');
                if (jobList) {
                    jobList.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                    
                    // èšç„¦åˆ°æœç´¢æ¡†
                    const searchInput = document.getElementById('jobSearch');
                    if (searchInput) {
                        searchInput.focus();
                    }
                }
            }, 100);
        }

        // å›åˆ°é¦–é¡µ
        function goToHome(event) {
            event.preventDefault();
            
            // åˆ‡æ¢åˆ°å®¶é•¿æ ‡ç­¾é¡µï¼ˆåˆå§‹çŠ¶æ€ï¼‰
            switchTab('parent');
            
            // æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // é€€å‡ºç™»å½•
        function logout() {
            // æ¸…é™¤æœ¬åœ°å­˜å‚¨çš„ç”¨æˆ·ä¿¡æ¯
            localStorage.removeItem('currentUser');
            
            // æ›´æ–°UIæ˜¾ç¤º
            updateUserDisplay();
            
            // æ˜¾ç¤ºé€€å‡ºæˆåŠŸæ¶ˆæ¯
            showMessage('å·²æˆåŠŸé€€å‡ºç™»å½•', 'success');
            
            // å»¶è¿Ÿä¸€ä¸‹å†åˆ·æ–°é¡µé¢ï¼Œç¡®ä¿æ¶ˆæ¯æ˜¾ç¤º
            setTimeout(() => {
                // é‡æ–°åŠ è½½é¡µé¢æ•°æ®
                loadTutorList();
                loadJobList();
            }, 1000);
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ç™»å½•çŠ¶æ€
        window.addEventListener('load', function() {
            updateUserDisplay();
            loadTutorListFromAPI();
            loadJobListFromAPI();
        });
    </script>
</body>
</html>